# منصة الامتحانات التفاعلية - دليل الإعداد

## المتطلبات
- Node.js 18+
- Neon PostgreSQL database
- نسخة من مشروع Next.js 16

## المتغيرات البيئية

أضف هذه المتغيرات إلى ملف `.env.local`:

```env
DATABASE_URL=your_neon_database_url
NODE_ENV=development
```

## الإعداد الأولي

### 1. تثبيت المكتبات
```bash
npm install
```

### 2. إنشاء قاعدة البيانات
تأكد من أن Neon PostgreSQL متصل، ثم قم بتشغيل migration:
```bash
npm run dev
```

الـ migration سيتم تشغيله تلقائياً عند بدء التطبيق.

### 3. تشغيل التطبيق
```bash
npm run dev
```

التطبيق سيكون متاحاً على `http://localhost:3000`

## هيكل المشروع

```
app/
├── page.tsx              # الصفحة الرئيسية
├── login/               # صفحة تسجيل الدخول
├── register/            # صفحة التسجيل
├── onboarding/          # صفحة إكمال البيانات
├── dashboard/           # لوحة الطالب الرئيسية
├── exam/[id]/           # صفحة الامتحان
├── results/[attemptId]/ # صفحة النتائج
├── history/             # سجل الامتحانات
├── admin/               # لوحة الإدارة
│   ├── page.tsx
│   ├── upload-exam/     # صفحة رفع امتحان جديد
│   └── exam/[id]/       # صفحة تفاصيل الامتحان
└── api/                 # API routes
    ├── auth/
    ├── student/
    ├── exam/
    ├── admin/
    └── ...

lib/
├── db.ts                # دوال قاعدة البيانات
├── auth.ts              # دوال التوثيق
└── theme-colors.ts      # نظام الألوان الديناميكي
```

## المميزات الرئيسية

### 1. نظام الألوان الديناميكي
- **للفتيات**: وردي وبنفسجي
- **للأولاد**: أزرق وأخضر وأصفر

يتم تحديد اللون بناءً على اختيار الجنس في صفحة Onboarding.

### 2. Progress Bar التفاعلي
يتم عرض أرنب صغير يتحرك نحو جزرة مع كل إجابة صحيحة على الأسئلة.

### 3. إدارة الامتحانات
- رفع أسئلة من ملفات Excel
- نشر الامتحانات للطلاب
- عرض الإحصائيات والتقارير

### 4. سجل الامتحانات
يمكن للطلاب الاطلاع على:
- درجاتهم السابقة
- تاريخ كل امتحان
- المتوسط الكلي للدرجات

## صيغة ملف Excel

عند رفع امتحان جديد، يجب أن يحتوي ملف Excel على الأعمدة التالية:

| question | optionA | optionB | optionC | optionD | correctAnswer |
|----------|---------|---------|---------|---------|---------------|
| السؤال الأول | الخيار 1 | الخيار 2 | الخيار 3 | الخيار 4 | A |
| السؤال الثاني | الخيار 1 | الخيار 2 | الخيار 3 | الخيار 4 | B |

- `question`: نص السؤال
- `optionA-D`: خيارات الإجابة
- `correctAnswer`: الإجابة الصحيحة (A أو B أو C أو D)

## سير العمل

### للطلاب:
1. تسجيل جديد أو تسجيل دخول
2. إكمال بيانات الملف الشخصي (اختيار الجنس، الصف، الترم، المادة)
3. الذهاب للامتحانات المتاحة
4. حل الامتحان مع ميزة الـ Progress Bar
5. عرض النتائج والسجل التاريخي

### للأدمن:
1. الذهاب إلى `/admin`
2. اختيار "رفع امتحان جديد"
3. ملء بيانات الامتحان واختيار ملف Excel
4. نشر الامتحان للطلاب

## API Endpoints

### Authentication
- `POST /api/auth/register` - التسجيل
- `POST /api/auth/login` - تسجيل الدخول
- `POST /api/auth/logout` - تسجيل الخروج

### Student Profile
- `GET /api/student/profile` - جلب بيانات الطالب
- `POST /api/onboarding/complete` - إكمال البيانات الشخصية
- `GET /api/student/attempts` - جلب سجل الامتحانات

### Exams
- `GET /api/exams` - جلب قائمة الامتحانات
- `GET /api/exam/:id` - جلب تفاصيل امتحان
- `GET /api/exam/:id/questions` - جلب أسئلة الامتحان
- `POST /api/exam/:id/submit` - إرسال الامتحان

### Results
- `GET /api/results/:attemptId` - جلب نتيجة محاولة

### Admin
- `GET /api/admin/stats` - جلب الإحصائيات
- `GET /api/admin/exams` - جلب قائمة الامتحانات
- `POST /api/admin/create-exam` - إنشاء امتحان جديد
- `POST /api/admin/exam/:id/publish` - نشر/إخفاء امتحان

## مشاكل شائعة

### خطأ في الاتصال بقاعدة البيانات
- تأكد من أن متغير `DATABASE_URL` صحيح
- تحقق من أن قاعدة البيانات تعمل

### الألوان لم تتغير
- تأكد من اختيار الجنس في صفحة Onboarding
- امسح الـ cookies وحاول مرة أخرى

### الامتحانات لم تظهر
- تأكد من نشر الامتحان من لوحة الإدارة
- تحقق من أن الامتحان لم يتم حذفه

## ملاحظات تطوير

- تم استخدام Neon PostgreSQL كقاعدة بيانات
- نظام authentication مخصص مع hash للكلمات المرورية
- Tailwind CSS للتصميم
- React 19 و Next.js 16

## الترخيص
جميع الحقوق محفوظة © 2024
